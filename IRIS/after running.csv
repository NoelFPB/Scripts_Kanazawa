This was with genetic:



Testing best configuration:
Configuration: {34: 2.0, 33: 0.5, 32: 1.0, 31: 2.0, 30: 1.0, 29: 0.5, 28: 3.5, 27: 0.1, 26: 2.5, 25: 4.0, 24: 3.0, 23: 0.5, 22: 4.9, 21: 2.0, 20: 2.5, 19: 4.9, 18: 2.5, 17: 4.5, 16: 4.0, 15: 0.5, 14: 4.5, 13: 3.5, 12: 1.5, 11: 2.5, 10: 3.0, 9: 3.5, 8: 4.9, 7: 2.5, 6: 0.1, 5: 1.5, 4: 3.5, 3: 2.5, 2: 3.5, 1: 0.1, 0: 3.5}
[2.325, 3.6, 2.354]
Sample 73 - True: Iris-versicolor, Predicted: Iris-versicolor
[4.692, 5.195, 4.368]
Sample 18 - True: Iris-setosa, Predicted: Iris-versicolor
[1.43, 3.019, 6.037]
Sample 118 - True: Iris-virginica, Predicted: Iris-virginica
[2.252, 3.782, 2.331]
Sample 78 - True: Iris-versicolor, Predicted: Iris-versicolor
[1.683, 4.271, 2.942]
Sample 76 - True: Iris-versicolor, Predicted: Iris-versicolor
[4.871, 1.886, 3.006]
Sample 31 - True: Iris-setosa, Predicted: Iris-setosa
[2.935, 3.462, 0.9061]
Sample 64 - True: Iris-versicolor, Predicted: Iris-versicolor
[1.697, 3.284, 4.345]
Sample 141 - True: Iris-virginica, Predicted: Iris-virginica
[1.678, 4.505, 2.612]
Sample 68 - True: Iris-versicolor, Predicted: Iris-versicolor
[2.577, 3.952, 0.9061]
Sample 82 - True: Iris-versicolor, Predicted: Iris-versicolor
[2.063, 3.092, 4.273]
Sample 110 - True: Iris-virginica, Predicted: Iris-virginica
[4.495, 1.451, 1.598]
Sample 12 - True: Iris-setosa, Predicted: Iris-setosa
[4.752, 2.379, 3.671]
Sample 36 - True: Iris-setosa, Predicted: Iris-setosa
[4.724, 1.301, 1.902]
Sample 9 - True: Iris-setosa, Predicted: Iris-setosa
[4.724, 5.19, 4.454]
Sample 19 - True: Iris-setosa, Predicted: Iris-versicolor
[3.486, 2.622, 2.417]
Sample 56 - True: Iris-versicolor, Predicted: Iris-setosa
[1.421, 3.037, 5.893]
Sample 104 - True: Iris-virginica, Predicted: Iris-virginica
[2.353, 4.303, 0.888]
Sample 69 - True: Iris-versicolor, Predicted: Iris-versicolor
[2.467, 3.49, 1.938]
Sample 55 - True: Iris-versicolor, Predicted: Iris-versicolor
[1.33, 2.845, 6.037]
Sample 132 - True: Iris-virginica, Predicted: Iris-virginica
[4.779, 1.351, 2.259]
Sample 29 - True: Iris-setosa, Predicted: Iris-setosa
[1.926, 3.17, 3.617]
Sample 127 - True: Iris-virginica, Predicted: Iris-virginica
[5.055, 1.854, 2.983]
Sample 26 - True: Iris-setosa, Predicted: Iris-setosa
[1.403, 2.836, 5.802]
Sample 128 - True: Iris-virginica, Predicted: Iris-virginica
[5.055, 1.447, 3.141]
Sample 131 - True: Iris-virginica, Predicted: Iris-setosa
[1.527, 3.248, 4.987]
Sample 145 - True: Iris-virginica, Predicted: Iris-virginica
[1.563, 3.01, 6.182]
Sample 108 - True: Iris-virginica, Predicted: Iris-virginica
[1.719, 3.211, 5.381]
Sample 143 - True: Iris-virginica, Predicted: Iris-virginica
[4.55, 1.561, 1.594]
Sample 45 - True: Iris-setosa, Predicted: Iris-setosa
[4.793, 1.269, 1.938]
Sample 30 - True: Iris-setosa, Predicted: Iris-setosa
[4.926, 3.202, 4.196]
Sample 22 - True: Iris-setosa, Predicted: Iris-setosa
[4.711, 5.241, 4.322]
Sample 15 - True: Iris-setosa, Predicted: Iris-versicolor
[2.821, 3.234, 1.526]
Sample 65 - True: Iris-versicolor, Predicted: Iris-versicolor
[4.839, 1.785, 3.051]
Sample 11 - True: Iris-setosa, Predicted: Iris-setosa
[4.825, 1.365, 2.508]
Sample 42 - True: Iris-setosa, Predicted: Iris-setosa
[1.71, 2.941, 4.114]
Sample 146 - True: Iris-virginica, Predicted: Iris-virginica
[3.077, 2.96, 1.82]
Sample 51 - True: Iris-versicolor, Predicted: Iris-setosa
[5.068, 2.306, 3.531]
Sample 27 - True: Iris-setosa, Predicted: Iris-setosa
[4.981, 3.175, 4.083]
Sample 4 - True: Iris-setosa, Predicted: Iris-setosa
[4.738, 5.167, 4.449]
Sample 32 - True: Iris-setosa, Predicted: Iris-versicolor
[1.642, 2.731, 4.544]
Sample 142 - True: Iris-virginica, Predicted: Iris-virginica
[4.21, 2.018, 2.069]
Sample 85 - True: Iris-versicolor, Predicted: Iris-setosa
[2.568, 3.577, 2.422]
Sample 86 - True: Iris-versicolor, Predicted: Iris-versicolor
[4.743, 5.305, 4.218]
Sample 16 - True: Iris-setosa, Predicted: Iris-versicolor
[4.834, 4.084, 4.241]
Sample 10 - True: Iris-setosa, Predicted: Iris-setosa

Confusion Matrix:
Predicted →
Actual ↓
            Setosa  Versicolor  Virginica
Iris-setosa       14           5         0
Iris-versicolor       3          10         0
Iris-virginica       1           0        12

Overall Accuracy: 80.00%


This is with SPSA:

    # Train
    best_config = serial_controller.train(
        config_manager=config_manager,
        data_processor=data_processor,
        oscilloscope=oscilloscope,
        learning_rate=0.2,
        delta=0.05,
        iterations=500
    )

    Best Configuration: {34: 4.66, 33: 1.78, 32: 2.6, 31: 4.64, 30: 0.8, 29: 4.9, 28: 1.78, 27: 3.78, 26: 3.08, 25: 4.64, 24: 3.84, 23: 1.19, 22: 1.97, 21: 1.22, 20: 2.75, 19: 4.44, 18: 4.79, 17: 0.3, 16: 2.21, 15: 1.14, 14: 4.12, 13: 3.43, 12: 3.06, 11: 2.86, 10: 1.66, 9: 0.76, 8: 2.6, 7: 2.27, 6: 2.37, 5: 0.14, 4: 0.94, 3: 4.32, 2: 4.2, 1: 0.68, 0: 2.54}

Starting Testing with Trained Configuration...
Sample outputs: [1.642, 6.95, 7.015]
Sample 73 - True: Iris-versicolor, Predicted: Iris-virginica
Sample outputs: [5.757, 3.385, 0.7659]
Sample 18 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [1.756, 6.982, 7.001]
Sample 118 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [1.637, 6.946, 6.992]
Sample 78 - True: Iris-versicolor, Predicted: Iris-virginica
Sample outputs: [1.738, 6.968, 7.001]
Sample 76 - True: Iris-versicolor, Predicted: Iris-virginica
Sample outputs: [6.431, 3.586, 0.7069]
Sample 31 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [2.559, 6.918, 6.133]
Sample 64 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [0.9397, 6.973, 7.001]
Sample 141 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [2.55, 6.973, 6.992]
Sample 68 - True: Iris-versicolor, Predicted: Iris-virginica
Sample outputs: [2.522, 6.946, 6.979]
Sample 82 - True: Iris-versicolor, Predicted: Iris-virginica
Sample outputs: [0.724, 6.959, 6.988]
Sample 110 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [4.582, 4.61, 2.96]
Sample 12 - True: Iris-setosa, Predicted: Iris-versicolor
Sample outputs: [6.651, 3.367, 0.4264]
Sample 36 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [5.238, 4.226, 2.35]
Sample 9 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [5.903, 3.234, 0.7704]
Sample 19 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [1.288, 6.968, 6.694]
Sample 56 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [0.9856, 6.978, 7.024]
Sample 104 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [2.509, 6.941, 7.019]
Sample 69 - True: Iris-versicolor, Predicted: Iris-virginica
Sample outputs: [1.706, 6.959, 7.015]
Sample 55 - True: Iris-versicolor, Predicted: Iris-virginica
Sample outputs: [1.435, 6.982, 7.019]
Sample 132 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [5.734, 4.034, 1.702]
Sample 29 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [1.045, 6.973, 6.992]
Sample 127 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [6.046, 3.485, 0.7387]
Sample 26 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [1.407, 6.991, 7.015]
Sample 128 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [1.041, 6.95, 6.119]
Sample 131 - True: Iris-virginica, Predicted: Iris-versicolor
Sample outputs: [0.9717, 6.991, 7.015]
Sample 145 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [1.779, 6.978, 7.024]
Sample 108 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [0.6507, 6.973, 7.028]
Sample 143 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [4.734, 4.445, 2.956]
Sample 45 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [5.123, 4.358, 2.341]
Sample 30 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [6.417, 3.056, 0.3992]
Sample 22 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [5.917, 3.303, 0.7432]
Sample 15 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [1.917, 6.973, 6.906]
Sample 65 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [6.101, 3.394, 0.7069]
Sample 11 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [5.367, 4.034, 1.775]
Sample 42 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [1.779, 6.973, 7.015]
Sample 146 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [1.742, 6.968, 6.675]
Sample 51 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [6.5, 3.33, 0.4491]
Sample 27 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [6.39, 3.193, 0.3584]
Sample 4 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [6.046, 3.193, 0.8109]
Sample 32 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [1.596, 6.964, 7.006]
Sample 142 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [1.747, 6.964, 5.721]
Sample 85 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [1.499, 6.973, 6.997]
Sample 86 - True: Iris-versicolor, Predicted: Iris-virginica
Sample outputs: [6.032, 3.074, 0.7659]
Sample 16 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [6.376, 3.133, 0.4987]
Sample 10 - True: Iris-setosa, Predicted: Iris-setosa

Confusion Matrix:
Predicted →
Actual ↓
            Setosa  Versicolor  Virginica
Iris-setosa       18           1         0
Iris-versicolor       0           5         8
Iris-virginica       0           1        12

Overall Accuracy: 77.78%

Changing learning rate apparently destroys the accuracy. This is for 0.15 only 28%


best_config = serial_controller.train(
        config_manager=config_manager,
        data_processor=data_processor,
        oscilloscope=oscilloscope,
        learning_rate=0.2,
        delta=0.1,
        iterations=500
    )
Confusion Matrix:
Predicted →
Actual ↓
            Setosa  Versicolor  Virginica
Iris-setosa        8           0        11
Iris-versicolor       0          11         2
Iris-virginica       0           0        13

Overall Accuracy: 71.11%


Training complete!
Best Configuration: {34: 3.03, 33: 3.48, 32: 2.86, 31: 3.41, 30: 3.52, 29: 1.63, 28: 0.16, 27: 4.12, 26: 0.75, 25: 0.31, 24: 0.13, 23: 1.04, 22: 4.02, 21: 3.24, 20: 0.71, 19: 1.91, 18: 1.05, 17: 3.14, 16: 3.67, 15: 2.23, 14: 0.21, 13: 0.1, 12: 2.77, 11: 2.05, 10: 1.96, 9: 2.44, 8: 3.74, 7: 0.18, 6: 3.99, 5: 0.36, 4: 1.81, 3: 3.33, 2: 4.23, 1: 2.3, 0: 4.14}

Starting Testing with Trained Configuration...
Sample outputs: [0.6003, 5.323, 4.816]
Sample 73 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [7.17, 7.087, 1.698]
Sample 18 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [1.802, 3.965, 7.191]
Sample 118 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [0.6827, 6.598, 4.006]
Sample 78 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [0.3432, 5.689, 5.178]
Sample 76 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [7.165, 7.087, 1.354]
Sample 31 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [2.004, 7.06, 2.82]
Sample 64 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [1.201, 6.635, 3.847]
Sample 141 - True: Iris-virginica, Predicted: Iris-versicolor
Sample outputs: [0.6552, 4.907, 7.133]
Sample 68 - True: Iris-versicolor, Predicted: Iris-virginica
Sample outputs: [1.298, 6.671, 3.924]
Sample 82 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [1.054, 6.964, 3.06]
Sample 110 - True: Iris-virginica, Predicted: Iris-versicolor
Sample outputs: [7.064, 7.06, 2.508]
Sample 12 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [7.179, 7.092, 1.187]
Sample 36 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [7.11, 7.069, 2.173]
Sample 9 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [7.165, 7.078, 1.653]
Sample 19 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [1.339, 7.11, 2.128]
Sample 56 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [1.274, 4.975, 5.413]
Sample 104 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [1.146, 6.013, 4.68]
Sample 69 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [0.7195, 5.753, 4.426]
Sample 55 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [1.385, 4.203, 7.078]
Sample 132 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [7.142, 7.06, 1.893]
Sample 29 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [1.009, 6.511, 4.137]
Sample 127 - True: Iris-virginica, Predicted: Iris-versicolor
Sample outputs: [7.165, 7.078, 1.367]
Sample 26 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [1.467, 4.207, 7.137]
Sample 128 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [1.632, 7.119, 2.612]
Sample 131 - True: Iris-virginica, Predicted: Iris-versicolor
Sample outputs: [1.165, 5.57, 4.983]
Sample 145 - True: Iris-virginica, Predicted: Iris-versicolor
Sample outputs: [1.573, 3.499, 7.205]
Sample 108 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [1.036, 6.31, 3.757]
Sample 143 - True: Iris-virginica, Predicted: Iris-versicolor
Sample outputs: [7.091, 7.046, 2.431]
Sample 45 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [7.123, 7.069, 2.173]
Sample 30 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [7.179, 7.101, 1.196]
Sample 22 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [7.183, 7.096, 1.653]
Sample 15 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [1.274, 7.064, 2.734]
Sample 65 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [7.179, 7.078, 1.359]
Sample 11 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [7.151, 7.074, 1.883]
Sample 42 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [1.197, 4.619, 7.164]
Sample 146 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [1.417, 7.087, 2.286]
Sample 51 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [7.174, 7.096, 1.2]
Sample 27 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [7.193, 7.096, 1.159]
Sample 4 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [7.174, 7.101, 1.711]
Sample 32 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [1.169, 4.445, 6.933]
Sample 142 - True: Iris-virginica, Predicted: Iris-virginica
Sample outputs: [2.215, 7.119, 1.784]
Sample 85 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [0.8157, 7.055, 3.042]
Sample 86 - True: Iris-versicolor, Predicted: Iris-versicolor
Sample outputs: [7.174, 7.078, 1.743]
Sample 16 - True: Iris-setosa, Predicted: Iris-setosa
Sample outputs: [7.197, 7.087, 1.381]
Sample 10 - True: Iris-setosa, Predicted: Iris-setosa

Confusion Matrix:
Predicted →
Actual ↓
            Setosa  Versicolor  Virginica
Iris-setosa       19           0         0
Iris-versicolor       0          12         1
Iris-virginica       0           6         7

Overall Accuracy: 84.44%


    # Train
    best_config = serial_controller.train(
        config_manager=config_manager,
        data_processor=data_processor,
        oscilloscope=oscilloscope,
        learning_rate=0.1,
        delta=0.5,
        iterations=300
    )
